<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CIOMS Form</title>
</head>
<body>

<style>
    @page {
        size: A4;
    }

    @media print {
        button {
            display: none;
        }

        body {
            margin: 0;
            padding: 0;
        }
    }

    html, body {
        max-width: 190mm;
        margin: 0 auto;
    }

    * {
        font-family: sans-serif;
        font-size: 10px;
    }

    h1, h2 {
        font-size: 14px;
    }

    textarea {
        resize: none;
        height: 100%;
    }

    h2 {
        text-align: center;
    }

    label, textarea, input[type="text"] {
        padding: 2px 2px 2px 4px;
    }

    table {
        border-collapse: collapse;
    }

    input[type="checkbox"], input[type="radio"] {
        accent-color: black;
        vertical-align: middle;
        margin-top: -1px;
    }

    input:not(input[type="checkbox"], input[type="radio"]), select, textarea {
        box-sizing: border-box;
        width: 100%;
        border: none;
        background: #f8f8ff;
    }

    .layout {
        display: grid;
        grid:
        "cioms_form cioms_form cioms_form cioms_form cioms_form cioms_form cioms_form cioms_form cioms_form cioms_form cioms_form" 1.6fr
        "suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report dummy1 dummy1 dummy1 dummy1 dummy1" 1fr
        "suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report dummy_text dummy_text dummy_text dummy_text dummy_text" 1fr
        "suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report suspect_adverse_reaction_report dummy2 dummy2 dummy2 dummy3 dummy3" 1fr
        "reaction reaction reaction reaction reaction reaction reaction reaction reaction reaction reaction" auto
        "patient_initials patient_initials country country date_of_birth date_of_birth age sex reaction_onset reaction_onset severity" auto
        "describe_reaction describe_reaction describe_reaction describe_reaction describe_reaction describe_reaction describe_reaction describe_reaction describe_reaction describe_reaction severity" auto
        "suspect_drug suspect_drug suspect_drug suspect_drug suspect_drug suspect_drug suspect_drug suspect_drug suspect_drug suspect_drug suspect_drug" auto
        "suspect_drug_1_name suspect_drug_1_name suspect_drug_1_name suspect_drug_1_name suspect_drug_1_name suspect_drug_1_name suspect_drug_1_name suspect_drug_1_name suspect_drug_1_name suspect_drug_1_name reaction_abate" auto
        "suspect_drug_1_daily_dose suspect_drug_1_daily_dose suspect_drug_1_daily_dose suspect_drug_1_daily_dose suspect_drug_1_daily_dose suspect_drug_1_daily_dose suspect_drug_1_route suspect_drug_1_route suspect_drug_1_route suspect_drug_1_route reaction_abate" auto
        "suspect_drug_1_indication_for_use suspect_drug_1_indication_for_use suspect_drug_1_indication_for_use suspect_drug_1_indication_for_use suspect_drug_1_indication_for_use suspect_drug_1_indication_for_use suspect_drug_1_indication_for_use suspect_drug_1_indication_for_use suspect_drug_1_indication_for_use suspect_drug_1_indication_for_use reaction_reappear" auto
        "suspect_drug_1_therapy_dates suspect_drug_1_therapy_dates suspect_drug_1_therapy_dates suspect_drug_1_therapy_dates suspect_drug_1_therapy_dates suspect_drug_1_therapy_dates suspect_drug_1_therapy_duration suspect_drug_1_therapy_duration suspect_drug_1_therapy_duration suspect_drug_1_therapy_duration reaction_reappear" auto
        "concomitant_drug concomitant_drug concomitant_drug concomitant_drug concomitant_drug concomitant_drug concomitant_drug concomitant_drug concomitant_drug concomitant_drug concomitant_drug" auto
        "concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration concomitant_drug_and_dates_of_administration" auto
        "other_relevant_history other_relevant_history other_relevant_history other_relevant_history other_relevant_history other_relevant_history other_relevant_history other_relevant_history other_relevant_history other_relevant_history other_relevant_history" auto
        "manufacturer manufacturer manufacturer manufacturer manufacturer manufacturer manufacturer manufacturer manufacturer manufacturer manufacturer" auto
        "name_and_address_of_manufacturer name_and_address_of_manufacturer name_and_address_of_manufacturer name_and_address_of_manufacturer name_and_address_of_manufacturer name_and_address_of_manufacturer text text text text text" auto
        "text2 text2 text2 manufacturer_control_number manufacturer_control_number manufacturer_control_number text text text text text" auto
        "date_received_by_manufacturer date_received_by_manufacturer date_received_by_manufacturer report_source report_source report_source text text text text text" auto
        "date_of_report date_of_report date_of_report report_type report_type report_type text text text text text" auto
        / 1.2fr 1fr 1fr 1fr 1fr 1.2fr 1fr 1fr 0.7fr 2fr 3fr;
        page-break-after: always;
    }

    .cioms_form {
        grid-area: cioms_form;
        text-align: right;
    }

    .suspect_adverse_reaction_report {
        grid-area: suspect_adverse_reaction_report;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .reaction {
        grid-area: reaction;
    }

    .patient_initials {
        grid-area: patient_initials;
    }

    .country {
        grid-area: country;
    }

    .date_of_birth {
        grid-area: date_of_birth;
    }

    .age {
        grid-area: age;
    }

    .sex {
        grid-area: sex;
    }

    .reaction_onset {
        grid-area: reaction_onset;
    }

    .severity {
        grid-area: severity;
    }

    .describe_reaction {
        grid-area: describe_reaction;
    }

    .suspect_drug {
        grid-area: suspect_drug;
    }

    .suspect_drug_1_name {
        grid-area: suspect_drug_1_name;
    }

    .suspect_drug_1_daily_dose {
        grid-area: suspect_drug_1_daily_dose;
    }

    .suspect_drug_1_route {
        grid-area: suspect_drug_1_route;
    }

    .suspect_drug_1_indication_for_use {
        grid-area: suspect_drug_1_indication_for_use;
    }

    .suspect_drug_1_therapy_dates {
        grid-area: suspect_drug_1_therapy_dates;
    }

    .suspect_drug_1_therapy_duration {
        grid-area: suspect_drug_1_therapy_duration;
    }

    .reaction_abate {
        grid-area: reaction_abate;
    }

    .reaction_reappear {
        grid-area: reaction_reappear;
    }

    .concomitant_drug {
        grid-area: concomitant_drug;
    }

    .concomitant_drug_and_dates_of_administration {
        grid-area: concomitant_drug_and_dates_of_administration;
    }

    .other_relevant_history {
        grid-area: other_relevant_history;
    }

    .manufacturer {
        grid-area: manufacturer;
    }

    .name_and_address_of_manufacturer {
        grid-area: name_and_address_of_manufacturer;
    }

    .manufacturer_control_number {
        grid-area: manufacturer_control_number;
    }

    .date_received_by_manufacturer {
        grid-area: date_received_by_manufacturer;
    }

    .report_source {
        grid-area: report_source;
    }

    .date_of_report {
        grid-area: date_of_report;
    }

    .report_type {
        grid-area: report_type;
    }

    .dummy1 {
        grid-area: dummy1;
    }

    .dummy2 {
        grid-area: dummy2;
    }

    .dummy3 {
        grid-area: dummy3;
        flex-direction: row;
        justify-content: space-evenly;
    }

    .dummy_text {
        grid-area: dummy_text;
    }

    .text {
        grid-area: text;
    }

    .text2 {
        grid-area: text2;
    }

    section > div {
        border-left: 0.05mm solid rgba(0, 0, 0, 0.5);
        border-top: 0.05mm solid rgba(0, 0, 0, 0.5);
        display: flex;
        flex-direction: column;
    }

    section > div:not(.severity, .reaction_abate, .reaction_reappear, .report_source, .report_type,
                      .dummy3, .suspect_adverse_reaction_report) {
        justify-content: space-between;
    }

    .cioms_form, .reaction, .suspect_drug, .concomitant_drug, .manufacturer, .continue {
        border: none;
    }

    label[for="date_of_birth"], label[for="reaction_onset"],
    .suspect_adverse_reaction_report,
    .describe_reaction, .severity, .suspect_drug_1_therapy_dates, .suspect_drug_1_therapy_duration, .reaction_reappear,
    .other_relevant_history,
    .date_of_report, .report_type,
    .text, .dummy2, .dummy3 {
        border-bottom: 0.05mm solid rgba(0, 0, 0, 0.5);
    }

    .date div:not(:last-child), th:not(:last-child), td:not(:last-child),
    .cell, #suspect_drug_1_therapy_from,
    .severity,
    .reaction_abate, .reaction_reappear,
    .concomitant_drug_and_dates_of_administration, .other_relevant_history,
    .text, .dummy1, .dummy_text, .dummy3 {
        border-right: 0.05mm solid rgba(0, 0, 0, 0.5);
    }

    div:has(input[type="radio"]) {
        display: flex;
    }

    label:has(input[type="checkbox"]), label:has(input[type="radio"]) {
        padding-left: 0;
        display: flex;
        align-items: flex-start;
    }

    #suspect_drug_1_therapy_dates {
        display: flex;
    }

    .date {
        height: 100%;
        display: flex;
    }

    .day, .month, .year {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    #severity {
        display: flex;
        flex-direction: column;
    }

    #report_source div {
        display: flex;
    }

    .dummy_text input, .text2 input {
        height: 100%;
    }

    #describe_reaction_continue {
        white-space: pre-wrap;
    }

    tr {
        border-top: 0.05mm solid rgba(0, 0, 0, 0.5);
    }

    table table tr:first-child {
        border-top: none;
    }

    .layout_continue > div:not(:has(h2)) {
        border-right: 0.05mm solid rgba(0, 0, 0, 0.5);
    }

    .layout_continue {
        border-bottom: 0.05mm solid rgba(0, 0, 0, 0.5);
    }

    .layout_continue div:has(div:empty) {
        display: none;
    }

    .layout_continue:not(:has(div div:not(:empty))) {
        display: none;
    }

    .button {
        display: flex;
        justify-content: space-around;
        margin: 10px 20px;
    }

    .cont-marker {
        position: absolute;
        bottom: 5px;
        right: 10px;
        font-weight: bold;
        font-size: 8px;
    }
    
    .continuation-header {
        font-weight: bold;
        margin-bottom: 5px;
    }
    
    .field-content {
        white-space: pre-wrap;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }
    
    .continuation-page {
        page-break-before: always;
        padding: 20px;
        font-family: sans-serif;
    }
    
    .continuation-section {
        margin-bottom: 20px;
        border-bottom: 1px solid #ccc;
        padding-bottom: 10px;
    }

    /* Стили для продолжения полей */
    section:nth-of-type(2) div > div {
        min-height: 50px;
    }

    section:nth-of-type(2) {
        page-break-before: always;
    }

    section:nth-of-type(2) div > div:empty {
        display: none;
    }

    section:nth-of-type(2) div:has(> div:empty) > label {
        display: none;
    }

    /* Новые стили для страниц продолжения */
    #continuation-pages {
        page-break-before: always;
    }
    
    .continuation-page-header {
        display: flex;
        justify-content: space-between;
        padding: 10px 0;
        border-bottom: 1px solid #000;
        margin-bottom: 15px;
    }
    
    .continuation-page-title {
        text-align: center;
        font-weight: bold;
        margin: 10px 0;
        font-size: 12px;
    }
    
    .continuation-subtitle {
        font-weight: bold;
        margin: 15px 0 5px;
        border-bottom: 1px solid #ccc;
        padding-bottom: 5px;
        text-transform: uppercase;
    }
    
    .reaction-info-item {
        margin-bottom: 10px;
    }
    
    .reaction-info-header {
        font-weight: bold;
    }
    
    .suspect-product-section {
        margin-top: 15px;
    }
    
    .product-reaction-level {
        margin: 20px 0;
        padding-left: 10px;
    }
    
    .causality-item {
        margin: 5px 0;
    }
    
    .causality-header {
        font-weight: bold;
        margin-bottom: 5px;
    }
    
    .concomitant-drug-item {
        margin-bottom: 15px;
    }
    
    .page-number {
        text-align: right;
    }
    
    .manufacturer-id {
        text-align: left;
    }
    
    .two-column {
        display: flex;
        justify-content: space-between;
    }
    
    .key-value {
        display: flex;
        margin-bottom: 5px;
    }
    
    .key {
        font-weight: bold;
        min-width: 150px;
    }
    
    .value {
        flex: 1;
        word-wrap: break-word;
        overflow-wrap: break-word;
    }

    /* Улучшения для переноса текста */
    textarea, .field-content {
        word-wrap: break-word;
        overflow-wrap: break-word;
        white-space: pre-wrap;
    }
</style>

<script>
    window.onload = function() {
        generateContinuationPages();
    };

    function generateContinuationPages() {
        let continuationContainer = document.getElementById('continuation-pages');
        if (!continuationContainer) {
            continuationContainer = document.createElement('div');
            continuationContainer.id = 'continuation-pages';
            document.body.appendChild(continuationContainer);
        }
        
        continuationContainer.innerHTML = '';
        
        const manufacturerName = document.getElementById('name_and_address_of_manufacturer')?.value || '';
        const manufacturerControlNo = document.getElementById('manufacturer_control_number')?.value || '';
        const reportDate = document.getElementById('date_of_report')?.value || '';
        
        const overflowFields = [];
        
        const fieldsToCheck = [
            { id: 'describe_reaction', title: '7 + 13 DESCRIBE REACTION(S)' },
            { id: 'concomitant_drug_and_dates_of_administration', title: 'CONCOMITANT DRUG(S) AND DATES OF ADMINISTRATION' },
            { id: 'other_relevant_history', title: 'OTHER RELEVANT HISTORY' },
            { id: 'name_and_address_of_manufacturer', title: 'NAME AND ADDRESS OF MANUFACTURER' }
        ];
        
        for (const field of fieldsToCheck) {
            const element = document.getElementById(field.id);
            if (!element) continue;
            
            const content = element.value;
            if (content && content.length > 300) { 
                overflowFields.push({
                    id: field.id,
                    title: field.title,
                    content: content
                });
                
                const contMarker = document.createElement('div');
                contMarker.className = 'cont-marker';
                contMarker.textContent = 'Cont...';
                
                const parent = element.parentElement;
                if (parent) {
                    parent.style.position = 'relative';
                    parent.appendChild(contMarker);
                }
                
                const truncatedText = truncateText(content, 300); // Уменьшили количество символов
                element.value = truncatedText + ' ...';
            }
        }
        
        if (overflowFields.length > 0) {
            const titleCont = document.createElement('div');
            titleCont.textContent = 'Continued...';
            titleCont.style.position = 'absolute';
            titleCont.style.bottom = '10px';
            titleCont.style.right = '10px';
            titleCont.style.fontWeight = 'bold';
            titleCont.style.fontSize = '10px';
            
            const titlePage = document.querySelector('section:first-of-type');
            if (titlePage) {
                titlePage.style.position = 'relative';
                titlePage.appendChild(titleCont);
            }
            
            createContinuationPage(overflowFields, manufacturerName, manufacturerControlNo, reportDate);
        }
    }

    function truncateText(text, maxLength) {
        if (!text || text.length <= maxLength) return text;
        
        let cutPoint = maxLength;
        while (cutPoint > maxLength * 0.8 && text[cutPoint] !== ' ') {
            cutPoint--;
        }
        
        if (cutPoint <= maxLength * 0.8) cutPoint = maxLength;
        
        return text.substring(0, cutPoint);
    }

    function createContinuationPage(overflowFields, manufacturerName, manufacturerControlNo, reportDate) {
        const container = document.getElementById('continuation-pages');
        
        const page = document.createElement('div');
        page.className = 'continuation-page';
        
        // Заголовок страницы
        const header = document.createElement('div');
        header.className = 'continuation-page-header';
        
        // Определяем короткое имя производителя (первая строка)
        const shortManufacturerName = manufacturerName.split('\n')[0] || '';
        
        header.innerHTML = `
            <div class="manufacturer-id">${shortManufacturerName}</div>
            <div class="page-number">Page 2 | ${reportDate}</div>
        `;
        page.appendChild(header);
        
        const subtitle = document.createElement('div');
        subtitle.className = 'continuation-page-title';
        subtitle.textContent = `Continuation Sheet for CIOMS report, ${document.getElementById('health_professional')?.checked ? 'Health Professional' : 'Cont'}`;
        page.appendChild(subtitle);
        
        addReactionInfoSection(page);
        
        for (const field of overflowFields) {
            const section = document.createElement('div');
            section.className = 'continuation-section';
            
            const title = document.createElement('div');
            title.className = 'continuation-subtitle';
            title.textContent = field.title;
            section.appendChild(title);
            
            const content = document.createElement('div');
            content.className = 'field-content';
            
            const continuationText = field.content.substring(300);
            content.textContent = continuationText;
            
            section.appendChild(content);
            page.appendChild(section);
        }
        
        const footer = document.createElement('div');
        footer.className = 'continuation-page-header';
        footer.innerHTML = `
            <div>Mfr. Control Number: ${manufacturerControlNo || ''}</div>
            <div>Page 2</div>
        `;
        page.appendChild(footer);
        
        container.appendChild(page);
    }

    function addReactionInfoSection(page) {
        const reactionSection = document.createElement('div');
        reactionSection.className = 'continuation-section';
        
        const reactionTitle = document.createElement('div');
        reactionTitle.className = 'continuation-subtitle';
        reactionTitle.textContent = 'REACTION INFORMATION';
        reactionSection.appendChild(reactionTitle);
        
        const reactionDescription = document.getElementById('describe_reaction')?.value || '';
        const reactionStartDay = document.getElementById('reaction_onset_day')?.value || '';
        const reactionStartMonth = document.getElementById('reaction_onset_month')?.value || '';
        const reactionStartYear = document.getElementById('reaction_onset_year')?.value || '';
        const reactionStartDate = `${reactionStartDay}.${reactionStartMonth}.${reactionStartYear}`;
        
        const reactionItem = document.createElement('div');
        reactionItem.className = 'reaction-info-item';
        reactionItem.innerHTML = `
            <div class="reaction-info-header">Reaction #1</div>
            <div>${truncateText(reactionDescription, 100) || 'No description provided'}...</div>
            <div>Start date: ${reactionStartDate}</div>
        `;
        reactionSection.appendChild(reactionItem);
        
        page.appendChild(reactionSection);
        
        addSuspectProductSection(page);
    }

    function addSuspectProductSection(page) {
        const suspectProductSection = document.createElement('div');
        suspectProductSection.className = 'continuation-section';
        
        const suspectTitle = document.createElement('div');
        suspectTitle.className = 'continuation-subtitle';
        suspectTitle.textContent = 'SUSPECT PRODUCT';
        suspectProductSection.appendChild(suspectTitle);
        
        const drugName = document.getElementById('suspect_drug_1_name')?.value || '';
        const drugDose = document.getElementById('suspect_drug_1_daily_dose')?.value || '';
        const drugRoute = document.getElementById('suspect_drug_1_route')?.value || '';
        const drugIndication = document.getElementById('suspect_drug_1_indication_for_use')?.value || '';
        
        if (drugName) {
            const drugSection = document.createElement('div');
            drugSection.className = 'suspect-product-section';
            
            drugSection.innerHTML = `
                <div class="key-value">
                    <div class="key">Suspect drug #1:</div>
                    <div class="value">${drugName || 'Unknown'}</div>
                </div>
                <div class="key-value">
                    <div class="key">Daily dose:</div>
                    <div class="value">${drugDose || 'Unknown'}</div>
                </div>
                <div class="key-value">
                    <div class="key">Route:</div>
                    <div class="value">${drugRoute || 'Unknown'}</div>
                </div>
                <div class="key-value">
                    <div class="key">Indication:</div>
                    <div class="value">${drugIndication || 'Unknown'}</div>
                </div>
            `;
            
            const matrixSection = document.createElement('div');
            matrixSection.className = 'product-reaction-level';
            
            matrixSection.innerHTML = `
                <div class="continuation-subtitle">Product-Reaction level</div>
                
                <div class="key-value">
                    <div class="key">Seq.No.:</div>
                    <div class="value">1</div>
                </div>
                <div class="key-value">
                    <div class="key">Drug:</div>
                    <div class="value">${drugName || 'Unknown'}</div>
                </div>
                
                <div class="causality-header">Causality</div>
                
                <div class="causality-item">
                    <div>Outcome after Change in dose: ${document.getElementById('abate_Y')?.checked ? 'Improved' : (document.getElementById('abate_N')?.checked ? 'No change' : 'Not applicable')}</div>
                    <div>Outcome after reintro. of dose: ${document.getElementById('reappear_Y')?.checked ? 'Recurred' : (document.getElementById('reappear_N')?.checked ? 'Did not recur' : 'Not applicable')}</div>
                    <div>Causality as per reporter (Drug/Vaccine): Not Reported</div>
                    <div>Causality as per Mfr.(Drug/Vaccine): Possible</div>
                    <div>Dechallenge: ${document.getElementById('abate_Y')?.checked ? 'Positive' : (document.getElementById('abate_N')?.checked ? 'Negative' : 'N/A')}</div>
                </div>
            `;
            drugSection.appendChild(matrixSection);
            suspectProductSection.appendChild(drugSection);
        } else {
            suspectProductSection.innerHTML += '<div>No Suspected product</div>';
        }
        
        page.appendChild(suspectProductSection);
    }

    function formatTextWithLineBreaks(text, maxLineLength) {
        if (!text) return "";
        
        const lines = text.split('\n');
        
        const formattedLines = lines.map(line => {
            if (line.length <= maxLineLength) return line;
            
            const chunks = [];
            let currentPos = 0;
            
            while (currentPos < line.length) {
                const chunkSize = Math.min(maxLineLength, line.length - currentPos);
                
                let breakPos = currentPos + chunkSize;
                if (breakPos < line.length) {
                    const lastSpacePos = line.lastIndexOf(' ', breakPos);
                    if (lastSpacePos > currentPos && lastSpacePos - currentPos >= maxLineLength * 0.7) {
                        breakPos = lastSpacePos + 1; // +1 чтобы не включать пробел в начало следующей строки
                    }
                }
                
                chunks.push(line.substring(currentPos, breakPos));
                currentPos = breakPos;
            }
            
            return chunks.join('\n');
        });
        
        return formattedLines.join('\n');
    }
</script>


<section class="layout">
    <div class="cioms_form">
        <h1>CIOMS FORM</h1>
    </div>

    <div class="suspect_adverse_reaction_report">
        <h2>SUSPECT ADVERSE REACTION REPORT</h2>
    </div>

    <div class="dummy1"></div>
    <div class="dummy_text">
        <input type="text">
    </div>
    <div class="dummy2"></div>
    <div class="dummy3">
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
        <div class="cell"></div>
    </div>

    <div class="reaction">
        <h2>I. REACTION INFORMATION</h2>
    </div>
    <div class="patient_initials">
        <label for="patient_initials">1. PATIENT INITIALS (first, last)</label>
        <input type="text" id="patient_initials" name="patient_initials"
               value="{{ f1_patient_initials|default:"UNK" }}" readonly>
    </div>
    <div class="country">
        <label for="country">1a. COUNTRY</label>
        <input type="text" id="country" name="country" value="{{ f1a_country|default:"UNK" }}" readonly>
    </div>
    <div class="date_of_birth">
        <label for="date_of_birth">2. DATE OF BIRTH</label>
        <div id="date_of_birth" class="date">
            <div class="day">
                <label for="day_of_birth">Day</label>
                <input type="text" id="day_of_birth" name="day_of_birth"
                       value="{{ f2_date_of_birth_day|default:"UNK" }}" readonly>
            </div>
            <div class="month">
                <label for="month_of_birth">Month</label>
                <input type="text" id="month_of_birth" name="month_of_birth"
                       value="{{ f2_date_of_birth_month|default:"UNK" }}" readonly>
            </div>
            <div class="year">
                <label for="year_of_birth">Year</label>
                <input type="text" id="year_of_birth" name="year_of_birth"
                       value="{{ f2_date_of_birth_year|default:"UNK" }}" readonly>
            </div>
        </div>
    </div>
    <div class="age">
        <label for="age">2a. AGE</label>
        <input type="text" id="age" name="age" value="{{ f2a_age|default:"UNK" }}" readonly>
    </div>
    <div class="sex">
        <label for="sex">3. SEX</label>
        <select id="sex" name="sex" disabled="disabled">
            <option value="F" {% if f3_sex == "F" %} selected {% endif %}>F</option>
            <option value="M" {% if f3_sex == "M" %} selected {% endif %}>M</option>
        </select>
    </div>
    <div class="reaction_onset">
        <label for="reaction_onset">4-6 REACTION ONSET</label>
        <div id="reaction_onset" class="date">
            <div class="day">
                <label for="reaction_onset_day">Day</label>
                <input type="text" id="reaction_onset_day" name="reaction_onset_day"
                       value="{{ f4_reaction_onset_day|default:"UNK" }}" readonly>
            </div>
            <div class="month">
                <label for="reaction_onset_month">Month</label>
                <input type="text" id="reaction_onset_month" name="reaction_onset_month"
                       value="{{ f5_reaction_onset_month|default:"UNK" }}" readonly>
            </div>
            <div class="year">
                <label for="reaction_onset_year">Year</label>
                <input type="text" id="reaction_onset_year" name="reaction_onset_year"
                       value="{{ f6_reaction_onset_year|default:"UNK" }}" readonly>
            </div>
        </div>
    </div>
    <div class="describe_reaction">
        <label for="describe_reaction">7 + 13 DESCRIBE REACTION(S) (including relevant tests/lab data)</label>
        <textarea rows="13" id="describe_reaction" name="describe_reaction" autocomplete="off" readonly>{{ f7_13_describe_reactions }}</textarea>
    </div>

    <div class="severity">
        <label>8-12 CHECK ALL APPROPRIATE TO ADVERSE REACTION</label>
        <div id="severity">
            <label for="severity_death">
                <input type="checkbox" id="severity_death" name="severity[]" value="death"
                        {% if f8_patient_died %} checked {% endif %} disabled="disabled">
                PATIENT DIED
            </label>
            <label for="severity_hospitalization">
                <input type="checkbox" id="severity_hospitalization" name="severity[]" value="hospitalization"
                        {% if f9_prolonged_hospitalization %} checked {% endif %} disabled="disabled">
                INVOLVED OR PROLONGED PATIENT HOSPITALISATION
            </label>
            <label for="severity_disability">
                <input type="checkbox" id="severity_disability" name="severity[]" value="disability"
                        {% if f10_disability_or_incapacity %} checked {% endif %} disabled="disabled">
                INVOLVED PERSISTENT OR SIGNIFICANT DISABILITY OR INCAPACITY
            </label>
            <label for="severity_life_threatening">
                <input type="checkbox" id="severity_life_threatening" name="severity[]" value="life_threatening"
                        {% if f11_life_threatening %} checked {% endif %} disabled="disabled">
                LIFE THREATENING
            </label>
            <label for="severity_other">
                <input type="checkbox" id="severity_other" name="severity[]" value="other"
                        {% if f12_other %} checked {% endif %} disabled="disabled">
                OTHER
            </label>
        </div>
    </div>

    <div class="suspect_drug">
        <h2>II. SUSPECT DRUG(S) INFORMATION</h2>
    </div>
    <div class="suspect_drug_1_name">
        <label for="suspect_drug_1_name">14. SUSPECT DRUG(S) (include generic name)</label>
        <input type="text" id="suspect_drug_1_name" name="suspect_drug_1_name"
               value="{{ f14_21_suspect_drugs.0.name }}{% if f14_21_suspect_drugs.0.dosages_information.0.lot_number %} {{ f14_21_suspect_drugs.0.dosages_information.0.lot_number }}{% endif %}"
               readonly>
    </div>
    <div class="suspect_drug_1_daily_dose">
        <label for="suspect_drug_1_daily_dose">15. DAILY DOSE(S)</label>
        <input type="text" id="suspect_drug_1_daily_dose" name="suspect_drug_1_daily_dose"
               value="{{ f14_21_suspect_drugs.0.dosages_information.0.daily_dose|default:"UNK" }}" readonly>
    </div>
    <div class="suspect_drug_1_route">
        <label for="suspect_drug_1_route">16. ROUTE(S) OF ADMINISTRATION</label>
        <input type="text" id="suspect_drug_1_route" name="suspect_drug_1_route"
               value="{{ f14_21_suspect_drugs.0.dosages_information.0.route_of_administration|default:"UNK" }}"
               readonly>
    </div>
    <div class="suspect_drug_1_indication_for_use">
        <label for="suspect_drug_1_indication_for_use">17. INDICATION(S) FOR USE</label>
        <input type="text" id="suspect_drug_1_indication_for_use" name="suspect_drug_1_indication_for_use"
               value="{{ f14_21_suspect_drugs.0.indications_for_use.0.primary_source|default:"UNK" }}{% if f14_21_suspect_drugs.0.indications_for_use.0.meddra %}({{ f14_21_suspect_drugs.0.indications_for_use.0.meddra }}){% endif %}" readonly>
    </div>
    <div class="suspect_drug_1_therapy_dates">
        <label>18. THERAPY DATES (from/to)</label>
        <div id="suspect_drug_1_therapy_dates">
            <input type="text" id="suspect_drug_1_therapy_from" name="suspect_drug_1_therapy_from"
                   value="{{ f14_21_suspect_drugs.0.dosages_information.0.therapy_dates_from|default:"UNK" }}" readonly>
            <input type="text" id="suspect_drug_1_therapy_to" name="suspect_drug_1_therapy_to"
                   value="{{ f14_21_suspect_drugs.0.dosages_information.0.therapy_dates_to|default:"UNK" }}" readonly>
        </div>
    </div>
    <div class="suspect_drug_1_therapy_duration">
        <label for="suspect_drug_1_therapy_duration">19. THERAPY DURATION</label>
        <input type="text" id="suspect_drug_1_therapy_duration" name="suspect_drug_1_therapy_duration"
               value="{{ f14_21_suspect_drugs.0.dosages_information.0.therapy_duration|default:"UNK" }}" readonly>
    </div>
    <div class="reaction_abate">
        <label for="reaction_abate">20. DID REACTION ABATE AFTER STOPPING DRUG?</label>
        <div>
            <label for="abate_Y">
                <input type="radio" id="abate_Y" name="reaction_abate" value="Y"
                        {% if f14_21_suspect_drugs.0.abate == "Y" %} checked {% endif %}
                       disabled="disabled">
                YES
            </label>
            <label for="abate_N">
                <input type="radio" id="abate_N" name="reaction_abate" value="N"
                        {% if f14_21_suspect_drugs.0.abate == "N" %} checked {% endif %}
                       disabled="disabled">
                NO
            </label>
            <label for="abate_NA">
                <input type="radio" id="abate_NA" name="reaction_abate" value="NA"
                        {% if f14_21_suspect_drugs.0.abate == "NA" %} checked {% endif %}
                       disabled="disabled">
                NA
            </label>
        </div>
    </div>
    <div class="reaction_reappear">
        <label for="reaction_reappear">21. DID REACTION REAPPEAR AFTER REINTRODUCTION?</label>
        <div>
            <label for="reappear_Y">
                <input type="radio" id="reappear_Y" name="reaction_reappear" value="Y"
                        {% if f14_21_suspect_drugs.0.reappear == "Y" %} checked {% endif %}
                       disabled="disabled">
                YES
            </label>
            <label for="reappear_N">
                <input type="radio" id="reappear_N" name="reaction_reappear" value="N"
                        {% if f14_21_suspect_drugs.0.reappear == "N" %} checked {% endif %}
                       disabled="disabled">
                NO
            </label>
            <label for="reappear_NA">
                <input type="radio" id="reappear_NA" name="reaction_reappear" value="NA"
                        {% if f14_21_suspect_drugs.0.reappear == "NA" %} checked {% endif %}
                       disabled="disabled">
                NA
            </label>
        </div>
    </div>

    <div class="concomitant_drug">
        <h2>III. CONCOMITANT DRUG(S) AND HISTORY</h2>
    </div>
    <div class="concomitant_drug_and_dates_of_administration">
        <label for="concomitant_drug_and_dates_of_administration">22. CONCOMITANT DRUG(S) AND DATES OF ADMINISTRATION
            (exclude those used to treat
            reaction)</label>
        <textarea rows="4" id="concomitant_drug_and_dates_of_administration"
                  name="concomitant_drug_and_dates_of_administration" autocomplete="off"
                  readonly>{{ f22_concomitant_drugs_and_dates_of_administration }}</textarea>
    </div>
    <div class="other_relevant_history">
        <label for="other_relevant_history">23. OTHER RELEVANT HISTORY (e.g. diagnostics, allergics, pregnancy with last
            month of
            period, etc.)</label>
        <textarea rows="4" id="other_relevant_history" name="other_relevant_history" autocomplete="off"
                  readonly>{{ f23_other_relevant_history|default:"UNK" }}</textarea>
    </div>

    <div class="manufacturer">
        <h2>IV. MANUFACTURER INFORMATION</h2>
    </div>
    <div class="name_and_address_of_manufacturer">
        <label for="name_and_address_of_manufacturer">24a. NAME AND ADDRESS OF MANUFACTURER</label>
        <textarea rows="6" id="name_and_address_of_manufacturer" name="name_and_address_of_manufacturer"
                  autocomplete="off" readonly>{{ f24a_name_and_address_of_manufacturer|default:"" }}</textarea>
    </div>
    <div class="text">
        <textarea></textarea>
    </div>
    <div class="text2">
        <input type="text">
    </div>
    <div class="manufacturer_control_number">
        <label for="manufacturer_control_number">24b. MFR CONTROL NO.</label>
        <input type="text" id="manufacturer_control_number" name="manufacturer_control_number"
               value="{{ f24b_MFR_control_no|default:"" }}" readonly>
    </div>
    <div class="date_received_by_manufacturer">
        <label for="date_received_by_manufacturer">24c. DATE RECEIVED BY MANUFACTURER</label>
        <input type="text" id="date_received_by_manufacturer" name="date_received_by_manufacturer"
               value="{{ f24c_date_received_by_manufacturer|default:"" }}" readonly>
    </div>
    <div class="report_source">
        <label>24d. REPORT SOURCE</label>
        <div id="report_source">
            <div>
                <label for="study">
                    <input type="checkbox" id="study" name="report_source[]" value="study"
                            {% if f24d_report_source_study %} checked {% endif %} disabled="disabled">
                    STUDY
                </label>
                <label for="literature">
                    <input type="checkbox" id="literature" name="report_source[]" value="literature"
                            {% if f24d_report_source_literature %} checked {% endif %} disabled="disabled">
                    LITERATURE
                </label>
            </div>
            <label for="health_professional">
                <input type="checkbox" id="health_professional" name="report_source[]" value="health_professional"
                        {% if f24d_report_source_health_professional %} checked {% endif %} disabled="disabled">
                HEALTH PROFESSIONAL
            </label>
        </div>
    </div>
    <div class="date_of_report">
        <label for="date_of_report">DATE OF THIS REPORT</label>
        <input type="text" id="date_of_report" name="date_of_report" value="{{ date_of_this_report|default:"" }}"
               readonly>
    </div>
    <div class="report_type">
        <label for="report_type">25a. REPORT TYPE</label>
        <div id="report_type">
            <label for="initial">
                <input type="radio" id="initial" name="report_type" value="initial"
                        {% if f25a_report_type %} checked {% endif %} disabled="disabled">
                INITIAL
            </label>
            <label for="followup">
                <input type="radio" id="followup" name="report_type" value="followup"
                        {% if not f25a_report_type %} checked {% endif %} disabled="disabled">
                FOLLOWUP
            </label>
        </div>
    </div>
</section>

<!-- Контейнер для страниц продолжения -->
<div id="continuation-pages"></div>

<div>
    <button onclick="print()">Save as PDF</button>
</div>

</body>
</html>
